{"ast":null,"code":"import React,{useState,useCallback}from'react';import PassPreview from'./components/PassPreview';import DesignEditor from'./components/DesignEditor';import'./App.css';import{CanvasPreviewCapture}from'./services/previewCapture';import{RotateCcw,Undo2,Redo2}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const defaultExp=(()=>{const d=new Date();d.setFullYear(d.getFullYear()+1);return d.toISOString().slice(0,10);})();const getDefaultDesign=()=>({backgroundColor:'#8B4513',foregroundColor:'#FFFFFF',labelColor:'#FFFFFF',stripBackgroundColor:'#F5F5F5',logoText:'COFFEE REWARDS',logoImage:null,logoFormat:'square',hideLogoText:false,secondaryFields:[{label:'Customer',value:'John Doe'},{label:'Redeemed',value:'4 out of 10'}],auxiliaryField:{label:'Next Reward',value:'Free coffee at 10 stamps'},stampsEarned:4,totalStamps:10,milestones:[5,10],logoSize:38,cardWidth:375,cardHeight:504,stripHeight:144,headerHeight:80,secondaryHeight:100,auxiliaryHeight:80,barcodeHeight:100,expirationDate:defaultExp});const[passDesign,setPassDesign]=useState(getDefaultDesign());const[designHistory,setDesignHistory]=useState([getDefaultDesign()]);const[historyIndex,setHistoryIndex]=useState(0);const[showEditor,setShowEditor]=useState(true);const[isGenerating,setIsGenerating]=useState(false);// History management functions\nconst addToHistory=newDesign=>{// Remove any future history if we're not at the end\nconst newHistory=designHistory.slice(0,historyIndex+1);newHistory.push(newDesign);// Limit history to 50 items\nif(newHistory.length>50){newHistory.shift();}else{setHistoryIndex(historyIndex+1);}setDesignHistory(newHistory);setPassDesign(newDesign);};const handleUndo=useCallback(()=>{if(historyIndex>0){const newIndex=historyIndex-1;setHistoryIndex(newIndex);setPassDesign(designHistory[newIndex]);}},[historyIndex,designHistory]);const handleRedo=useCallback(()=>{if(historyIndex<designHistory.length-1){const newIndex=historyIndex+1;setHistoryIndex(newIndex);setPassDesign(designHistory[newIndex]);}},[historyIndex,designHistory]);const handleReset=()=>{if(window.confirm('Are you sure you want to reset to default? This will clear all your changes and cannot be undone.')){const defaultDesign=getDefaultDesign();setPassDesign(defaultDesign);setDesignHistory([defaultDesign]);setHistoryIndex(0);}};const handleDesignChange=newDesign=>{addToHistory(newDesign);};// Keyboard shortcuts\nReact.useEffect(()=>{const handleKeyDown=e=>{if(e.metaKey||e.ctrlKey){if(e.key==='z'&&!e.shiftKey){e.preventDefault();handleUndo();}else if(e.key==='z'&&e.shiftKey||e.key==='y'){e.preventDefault();handleRedo();}}};window.addEventListener('keydown',handleKeyDown);return()=>window.removeEventListener('keydown',handleKeyDown);},[historyIndex,designHistory,handleUndo,handleRedo]);const handleGeneratePass=async()=>{try{setIsGenerating(true);// 1) Capture strip from live preview\nconst stripEl=document.querySelector('.stamp-strip-container');if(!stripEl){alert('Could not find the live preview strip to capture.');return;}const capturer=new CanvasPreviewCapture();const stripPngDataUrl=await capturer.captureStripElement(stripEl);// 2) Build payload from current design\nconst payload={campaignId:'550e8400-e29b-41d4-a716-446655440001',campaignName:passDesign.logoText||'Demo Campaign',tenantName:'MKTR Platform',customerEmail:'demo@mktr.sg',customerName:passDesign.secondaryFields&&passDesign.secondaryFields.length>0?passDesign.secondaryFields[0].value||'Customer Name':'Customer Name',stampsEarned:passDesign.stampsEarned,stampsRequired:passDesign.totalStamps,expirationDate:passDesign.expirationDate,colors:{foreground:passDesign.foregroundColor,background:passDesign.backgroundColor,label:passDesign.labelColor,stripBackground:passDesign.stripBackgroundColor},images:{stripImage:stripPngDataUrl,logo:passDesign.logoImage||undefined,logoImage:passDesign.logoImage||undefined}};// 3) Request backend to generate working pass and return .pkpass\nconst res=await fetch('/api/passes/generate-working',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!res.ok){const err=await res.json().catch(()=>({}));throw new Error(err.message||'Failed to generate pass');}// 4) Download the pkpass\nconst blob=await res.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=\"\".concat((payload.campaignName||'pass').replace(/\\s+/g,'_'),\".pkpass\");document.body.appendChild(a);a.click();a.remove();window.URL.revokeObjectURL(url);}catch(e){console.error('Generate pass failed',e);alert((e===null||e===void 0?void 0:e.message)||'Failed to generate pass');}finally{setIsGenerating(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow-sm border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center h-16\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-bold text-sm\",children:\"\\uD83D\\uDCF1\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold text-gray-900\",children:\"Apple Wallet Pass Designer\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Create custom loyalty passes\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1 bg-gray-100 rounded-lg p-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleUndo,disabled:historyIndex<=0,className:\"p-2 rounded-md hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-all\",title:\"Undo (Cmd+Z)\",children:/*#__PURE__*/_jsx(Undo2,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRedo,disabled:historyIndex>=designHistory.length-1,className:\"p-2 rounded-md hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-all\",title:\"Redo (Cmd+Shift+Z)\",children:/*#__PURE__*/_jsx(Redo2,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-px h-6 bg-gray-300 mx-1\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleReset,className:\"p-2 rounded-md hover:bg-white text-red-600 hover:text-red-700 transition-all\",title:\"Reset to Default\",children:/*#__PURE__*/_jsx(RotateCcw,{className:\"w-4 h-4\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-px h-6 bg-gray-300\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowEditor(!showEditor),className:\"px-4 py-2 rounded-lg font-medium transition-all duration-200 \".concat(showEditor?'bg-gray-100 text-gray-700 hover:bg-gray-200':'bg-blue-600 text-white hover:bg-blue-700 shadow-sm'),children:showEditor?'Hide Editor':'Show Editor'})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex h-[calc(100vh-64px)]\",children:[showEditor&&/*#__PURE__*/_jsx(\"div\",{className:\"w-96 bg-white border-r border-gray-200 shadow-sm\",children:/*#__PURE__*/_jsx(DesignEditor,{design:passDesign,onDesignChange:handleDesignChange})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col items-center justify-center p-8 bg-gradient-to-br from-gray-50 to-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-2\",children:\"Live Preview\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Your Apple Wallet pass updates in real-time\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"transform hover:scale-105 transition-transform duration-300\",children:/*#__PURE__*/_jsx(PassPreview,{design:passDesign})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-8 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center space-x-2 px-4 py-2 bg-white rounded-lg shadow-sm border border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Live Preview Active\"})]}),designHistory.length>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center space-x-2 px-3 py-2 bg-white rounded-lg shadow-sm border border-gray-200\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:\"History:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs font-medium text-gray-700\",children:[historyIndex+1,\" / \",designHistory.length]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleGeneratePass,disabled:isGenerating,className:\"px-4 py-2 rounded-lg font-medium transition-all duration-200 \".concat(isGenerating?'bg-gray-200 text-gray-500 cursor-not-allowed':'bg-blue-600 text-white hover:bg-blue-700 shadow-sm'),children:isGenerating?'Generatingâ€¦':'Generate Pass'})]})})]})]})]});}export default App;","map":{"version":3,"names":["React","useState","useCallback","PassPreview","DesignEditor","CanvasPreviewCapture","RotateCcw","Undo2","Redo2","jsx","_jsx","jsxs","_jsxs","App","defaultExp","d","Date","setFullYear","getFullYear","toISOString","slice","getDefaultDesign","backgroundColor","foregroundColor","labelColor","stripBackgroundColor","logoText","logoImage","logoFormat","hideLogoText","secondaryFields","label","value","auxiliaryField","stampsEarned","totalStamps","milestones","logoSize","cardWidth","cardHeight","stripHeight","headerHeight","secondaryHeight","auxiliaryHeight","barcodeHeight","expirationDate","passDesign","setPassDesign","designHistory","setDesignHistory","historyIndex","setHistoryIndex","showEditor","setShowEditor","isGenerating","setIsGenerating","addToHistory","newDesign","newHistory","push","length","shift","handleUndo","newIndex","handleRedo","handleReset","window","confirm","defaultDesign","handleDesignChange","useEffect","handleKeyDown","e","metaKey","ctrlKey","key","shiftKey","preventDefault","addEventListener","removeEventListener","handleGeneratePass","stripEl","document","querySelector","alert","capturer","stripPngDataUrl","captureStripElement","payload","campaignId","campaignName","tenantName","customerEmail","customerName","stampsRequired","colors","foreground","background","stripBackground","images","stripImage","logo","undefined","res","fetch","method","headers","body","JSON","stringify","ok","err","json","catch","Error","message","blob","url","URL","createObjectURL","a","createElement","href","download","concat","replace","appendChild","click","remove","revokeObjectURL","console","error","className","children","onClick","disabled","title","design","onDesignChange"],"sources":["/Users/shawnlee/Documents/GitHub/passes-mktr/src/frontend/src/App.tsx"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport PassPreview from './components/PassPreview';\nimport DesignEditor from './components/DesignEditor';\nimport { PassDesign } from './types';\nimport './App.css';\nimport { CanvasPreviewCapture } from './services/previewCapture';\nimport { RotateCcw, Undo2, Redo2 } from 'lucide-react';\n\nfunction App() {\n  const defaultExp = (() => {\n    const d = new Date();\n    d.setFullYear(d.getFullYear() + 1);\n    return d.toISOString().slice(0, 10);\n  })();\n  \n  const getDefaultDesign = (): PassDesign => ({\n    backgroundColor: '#8B4513',\n    foregroundColor: '#FFFFFF',\n    labelColor: '#FFFFFF',\n    stripBackgroundColor: '#F5F5F5',\n    logoText: 'COFFEE REWARDS',\n    logoImage: null,\n    logoFormat: 'square',\n    hideLogoText: false,\n    secondaryFields: [\n      { label: 'Customer', value: 'John Doe' },\n      { label: 'Redeemed', value: '4 out of 10' }\n    ],\n    auxiliaryField: {\n      label: 'Next Reward',\n      value: 'Free coffee at 10 stamps'\n    },\n    stampsEarned: 4,\n    totalStamps: 10,\n    milestones: [5, 10],\n    logoSize: 38,\n    cardWidth: 375,\n    cardHeight: 504,\n    stripHeight: 144,\n    headerHeight: 80,\n    secondaryHeight: 100,\n    auxiliaryHeight: 80,\n    barcodeHeight: 100,\n    expirationDate: defaultExp\n  });\n\n  const [passDesign, setPassDesign] = useState<PassDesign>(getDefaultDesign());\n  const [designHistory, setDesignHistory] = useState<PassDesign[]>([getDefaultDesign()]);\n  const [historyIndex, setHistoryIndex] = useState(0);\n  const [showEditor, setShowEditor] = useState(true);\n  const [isGenerating, setIsGenerating] = useState(false);\n\n  // History management functions\n  const addToHistory = (newDesign: PassDesign) => {\n    // Remove any future history if we're not at the end\n    const newHistory = designHistory.slice(0, historyIndex + 1);\n    newHistory.push(newDesign);\n    \n    // Limit history to 50 items\n    if (newHistory.length > 50) {\n      newHistory.shift();\n    } else {\n      setHistoryIndex(historyIndex + 1);\n    }\n    \n    setDesignHistory(newHistory);\n    setPassDesign(newDesign);\n  };\n\n  const handleUndo = useCallback(() => {\n    if (historyIndex > 0) {\n      const newIndex = historyIndex - 1;\n      setHistoryIndex(newIndex);\n      setPassDesign(designHistory[newIndex]);\n    }\n  }, [historyIndex, designHistory]);\n\n  const handleRedo = useCallback(() => {\n    if (historyIndex < designHistory.length - 1) {\n      const newIndex = historyIndex + 1;\n      setHistoryIndex(newIndex);\n      setPassDesign(designHistory[newIndex]);\n    }\n  }, [historyIndex, designHistory]);\n\n  const handleReset = () => {\n    if (window.confirm('Are you sure you want to reset to default? This will clear all your changes and cannot be undone.')) {\n      const defaultDesign = getDefaultDesign();\n      setPassDesign(defaultDesign);\n      setDesignHistory([defaultDesign]);\n      setHistoryIndex(0);\n    }\n  };\n\n  const handleDesignChange = (newDesign: PassDesign) => {\n    addToHistory(newDesign);\n  };\n\n  // Keyboard shortcuts\n  React.useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.metaKey || e.ctrlKey) {\n        if (e.key === 'z' && !e.shiftKey) {\n          e.preventDefault();\n          handleUndo();\n        } else if ((e.key === 'z' && e.shiftKey) || e.key === 'y') {\n          e.preventDefault();\n          handleRedo();\n        }\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [historyIndex, designHistory, handleUndo, handleRedo]);\n\n  const handleGeneratePass = async () => {\n    try {\n      setIsGenerating(true);\n      // 1) Capture strip from live preview\n      const stripEl = document.querySelector('.stamp-strip-container') as HTMLElement | null;\n      if (!stripEl) {\n        alert('Could not find the live preview strip to capture.');\n        return;\n      }\n      const capturer = new CanvasPreviewCapture();\n      const stripPngDataUrl = await capturer.captureStripElement(stripEl);\n\n      // 2) Build payload from current design\n      const payload = {\n        campaignId: '550e8400-e29b-41d4-a716-446655440001',\n        campaignName: passDesign.logoText || 'Demo Campaign',\n        tenantName: 'MKTR Platform',\n        customerEmail: 'demo@mktr.sg',\n        customerName: passDesign.secondaryFields && passDesign.secondaryFields.length > 0 ? (passDesign.secondaryFields[0].value || 'Customer Name') : 'Customer Name',\n        stampsEarned: passDesign.stampsEarned,\n        stampsRequired: passDesign.totalStamps,\n        expirationDate: passDesign.expirationDate,\n        colors: {\n          foreground: passDesign.foregroundColor,\n          background: passDesign.backgroundColor,\n          label: passDesign.labelColor,\n          stripBackground: passDesign.stripBackgroundColor\n        },\n        images: {\n          stripImage: stripPngDataUrl,\n          logo: passDesign.logoImage || undefined,\n          logoImage: passDesign.logoImage || undefined\n        }\n      };\n\n      // 3) Request backend to generate working pass and return .pkpass\n      const res = await fetch('/api/passes/generate-working', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      });\n\n      if (!res.ok) {\n        const err = await res.json().catch(() => ({}));\n        throw new Error(err.message || 'Failed to generate pass');\n      }\n\n      // 4) Download the pkpass\n      const blob = await res.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `${(payload.campaignName || 'pass').replace(/\\s+/g, '_')}.pkpass`;\n      document.body.appendChild(a);\n      a.click();\n      a.remove();\n      window.URL.revokeObjectURL(url);\n    } catch (e: any) {\n      console.error('Generate pass failed', e);\n      alert(e?.message || 'Failed to generate pass');\n    } finally {\n      setIsGenerating(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white shadow-sm border-b border-gray-200\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center\">\n                <span className=\"text-white font-bold text-sm\">ðŸ“±</span>\n              </div>\n              <div>\n                <h1 className=\"text-xl font-semibold text-gray-900\">\n                  Apple Wallet Pass Designer\n                </h1>\n                <p className=\"text-sm text-gray-500\">Create custom loyalty passes</p>\n              </div>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              {/* History Controls */}\n              <div className=\"flex items-center space-x-1 bg-gray-100 rounded-lg p-1\">\n                <button\n                  onClick={handleUndo}\n                  disabled={historyIndex <= 0}\n                  className=\"p-2 rounded-md hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n                  title=\"Undo (Cmd+Z)\"\n                >\n                  <Undo2 className=\"w-4 h-4\" />\n                </button>\n                <button\n                  onClick={handleRedo}\n                  disabled={historyIndex >= designHistory.length - 1}\n                  className=\"p-2 rounded-md hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n                  title=\"Redo (Cmd+Shift+Z)\"\n                >\n                  <Redo2 className=\"w-4 h-4\" />\n                </button>\n                <div className=\"w-px h-6 bg-gray-300 mx-1\"></div>\n                <button\n                  onClick={handleReset}\n                  className=\"p-2 rounded-md hover:bg-white text-red-600 hover:text-red-700 transition-all\"\n                  title=\"Reset to Default\"\n                >\n                  <RotateCcw className=\"w-4 h-4\" />\n                </button>\n              </div>\n\n              <div className=\"w-px h-6 bg-gray-300\"></div>\n\n              <button\n                onClick={() => setShowEditor(!showEditor)}\n                className={`px-4 py-2 rounded-lg font-medium transition-all duration-200 ${\n                  showEditor \n                    ? 'bg-gray-100 text-gray-700 hover:bg-gray-200' \n                    : 'bg-blue-600 text-white hover:bg-blue-700 shadow-sm'\n                }`}\n              >\n                {showEditor ? 'Hide Editor' : 'Show Editor'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"flex h-[calc(100vh-64px)]\">\n        {/* Design Editor Sidebar */}\n        {showEditor && (\n          <div className=\"w-96 bg-white border-r border-gray-200 shadow-sm\">\n            <DesignEditor \n              design={passDesign} \n              onDesignChange={handleDesignChange}\n            />\n          </div>\n        )}\n\n        {/* Pass Preview */}\n        <div className=\"flex-1 flex flex-col items-center justify-center p-8 bg-gradient-to-br from-gray-50 to-gray-100\">\n          <div className=\"text-center mb-8\">\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Live Preview</h2>\n            <p className=\"text-gray-600\">Your Apple Wallet pass updates in real-time</p>\n          </div>\n          <div className=\"transform hover:scale-105 transition-transform duration-300\">\n            <PassPreview design={passDesign} />\n          </div>\n          <div className=\"mt-8 text-center\">\n          <div className=\"flex items-center justify-center gap-3\">\n            <div className=\"inline-flex items-center space-x-2 px-4 py-2 bg-white rounded-lg shadow-sm border border-gray-200\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n              <span className=\"text-sm text-gray-600\">Live Preview Active</span>\n            </div>\n            {designHistory.length > 1 && (\n              <div className=\"inline-flex items-center space-x-2 px-3 py-2 bg-white rounded-lg shadow-sm border border-gray-200\">\n                <span className=\"text-xs text-gray-500\">History:</span>\n                <span className=\"text-xs font-medium text-gray-700\">\n                  {historyIndex + 1} / {designHistory.length}\n                </span>\n              </div>\n            )}\n            <button\n              onClick={handleGeneratePass}\n              disabled={isGenerating}\n              className={`px-4 py-2 rounded-lg font-medium transition-all duration-200 ${\n                isGenerating\n                  ? 'bg-gray-200 text-gray-500 cursor-not-allowed'\n                  : 'bg-blue-600 text-white hover:bg-blue-700 shadow-sm'\n              }`}\n            >\n              {isGenerating ? 'Generatingâ€¦' : 'Generate Pass'}\n            </button>\n          </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}