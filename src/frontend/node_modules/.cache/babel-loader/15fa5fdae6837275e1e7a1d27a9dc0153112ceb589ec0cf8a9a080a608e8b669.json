{"ast":null,"code":"import React,{useState,useCallback}from'react';import PassPreview from'./components/PassPreview';import DesignEditor from'./components/DesignEditor';import'./App.css';import{CanvasPreviewCapture}from'./services/previewCapture';import{RotateCcw,Undo2,Redo2,CreditCard,Star,Target}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const defaultExp=(()=>{const d=new Date();d.setFullYear(d.getFullYear()+1);return d.toISOString().slice(0,10);})();const getDefaultDesign=function(){let cardType=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'redemption';return{cardType,backgroundColor:'#8B4513',foregroundColor:'#FFFFFF',labelColor:'#FFFFFF',stripBackgroundColor:'#F5F5F5',logoText:'COFFEE REWARDS',logoImage:null,logoFormat:'square',hideLogoText:false,secondaryFields:[{label:'Card Holder',value:'John Doe'},{label:'Redeemed',value:'4 out of 10'}],auxiliaryField:{label:'Next Reward',value:'Free coffee at 10 stamps'},// Redemption Card Fields\nstampsEarned:4,totalStamps:10,milestones:[5,10],// Points Card Fields\npointsBalance:1250,pointsEarned:1250,pointsRequired:2000,pointsPerTransaction:50,nextRewardPoints:2000,// Milestone Card Fields\nmilestoneLevels:[{level:1,name:'Bronze',pointsRequired:500,reward:'10% off'},{level:2,name:'Silver',pointsRequired:1000,reward:'15% off'},{level:3,name:'Gold',pointsRequired:2000,reward:'20% off'},{level:4,name:'Platinum',pointsRequired:5000,reward:'Free coffee'}],currentMilestone:2,nextMilestonePoints:2000,logoSize:38,cardWidth:375,cardHeight:504,stripHeight:144,headerHeight:80,secondaryHeight:100,auxiliaryHeight:80,barcodeHeight:100,qrAltText:'Loyalty Card QR Code',expirationDate:defaultExp,hasExpiryDate:false};};const[passDesign,setPassDesign]=useState(getDefaultDesign());const[designHistory,setDesignHistory]=useState([getDefaultDesign()]);const[historyIndex,setHistoryIndex]=useState(0);const[showEditor,setShowEditor]=useState(true);const[isGenerating,setIsGenerating]=useState(false);// History management functions\nconst addToHistory=newDesign=>{// Remove any future history if we're not at the end\nconst newHistory=designHistory.slice(0,historyIndex+1);newHistory.push(newDesign);// Limit history to 50 items\nif(newHistory.length>50){newHistory.shift();}else{setHistoryIndex(historyIndex+1);}setDesignHistory(newHistory);setPassDesign(newDesign);};const handleUndo=useCallback(()=>{if(historyIndex>0){const newIndex=historyIndex-1;setHistoryIndex(newIndex);setPassDesign(designHistory[newIndex]);}},[historyIndex,designHistory]);const handleRedo=useCallback(()=>{if(historyIndex<designHistory.length-1){const newIndex=historyIndex+1;setHistoryIndex(newIndex);setPassDesign(designHistory[newIndex]);}},[historyIndex,designHistory]);const handleReset=()=>{if(window.confirm('Are you sure you want to reset to default? This will clear all your changes and cannot be undone.')){const defaultDesign=getDefaultDesign();setPassDesign(defaultDesign);setDesignHistory([defaultDesign]);setHistoryIndex(0);}};const handleDesignChange=newDesign=>{addToHistory(newDesign);};const handleCardTypeChange=newCardType=>{if(newCardType===passDesign.cardType)return;// Create a new design with the selected card type and appropriate default fields\nconst newDesign=getDefaultDesign(newCardType);// Preserve some common settings\nnewDesign.backgroundColor=passDesign.backgroundColor;newDesign.foregroundColor=passDesign.foregroundColor;newDesign.labelColor=passDesign.labelColor;newDesign.stripBackgroundColor=passDesign.stripBackgroundColor;newDesign.logoText=passDesign.logoText;newDesign.logoImage=passDesign.logoImage;newDesign.logoFormat=passDesign.logoFormat;newDesign.hideLogoText=passDesign.hideLogoText;newDesign.qrAltText=passDesign.qrAltText;newDesign.expirationDate=passDesign.expirationDate;newDesign.hasExpiryDate=passDesign.hasExpiryDate;addToHistory(newDesign);};// Keyboard shortcuts\nReact.useEffect(()=>{const handleKeyDown=e=>{if(e.metaKey||e.ctrlKey){if(e.key==='z'&&!e.shiftKey){e.preventDefault();handleUndo();}else if(e.key==='z'&&e.shiftKey||e.key==='y'){e.preventDefault();handleRedo();}}};window.addEventListener('keydown',handleKeyDown);return()=>window.removeEventListener('keydown',handleKeyDown);},[historyIndex,designHistory,handleUndo,handleRedo]);const handleGeneratePass=async()=>{try{setIsGenerating(true);// 1) Capture strip from live preview\nconst stripEl=document.querySelector('.stamp-strip-container');if(!stripEl){alert('Could not find the live preview strip to capture.');return;}const capturer=new CanvasPreviewCapture();const stripPngDataUrl=await capturer.captureStripElement(stripEl);// 2) Build payload from current design\nconst payload={campaignId:'550e8400-e29b-41d4-a716-446655440001',campaignName:passDesign.logoText||'',tenantName:'MKTR Platform',customerEmail:'demo@mktr.sg',customerName:passDesign.secondaryFields&&passDesign.secondaryFields.length>0?passDesign.secondaryFields[0].value||'Customer Name':'Customer Name',stampsEarned:passDesign.stampsEarned,stampsRequired:passDesign.totalStamps,expirationDate:passDesign.expirationDate,hasExpiryDate:passDesign.hasExpiryDate,colors:{foreground:passDesign.foregroundColor,background:passDesign.backgroundColor,label:passDesign.labelColor,stripBackground:passDesign.stripBackgroundColor},images:{stripImage:stripPngDataUrl,logo:passDesign.logoImage||undefined,logoImage:passDesign.logoImage||undefined},qrAltText:passDesign.qrAltText||'Loyalty Card QR Code',fieldConfig:{fields:{header:[passDesign.cardType==='redemption'?{key:'expiryDate',label:'EXPIRY',value:passDesign.hasExpiryDate&&passDesign.expirationDate?new Date(passDesign.expirationDate).toLocaleDateString('en-GB',{day:'2-digit',month:'2-digit',year:'numeric'}).replace(/\\//g,'/'):'No Expiry',textAlignment:'PKTextAlignmentRight'}:{key:'pointsValue',label:'POINTS',value:'1836',textAlignment:'PKTextAlignmentRight'}],primary:[],auxiliary:[{key:'points',label:'POINTS',value:'12,345',textAlignment:'PKTextAlignmentRight'}]}}};// 3) Request backend to generate working pass and return .pkpass\nconst res=await fetch('/api/passes/generate-working',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!res.ok){const err=await res.json().catch(()=>({}));throw new Error(err.message||'Failed to generate pass');}// 4) Debug: Log provenance headers for the files used\ntry{const logo=res.headers.get('X-Pass-Logo');const logo2x=res.headers.get('X-Pass-Logo2x');const logo3x=res.headers.get('X-Pass-Logo3x');const logoSource=res.headers.get('X-Pass-Logo-Source');const icon=res.headers.get('X-Pass-Icon');const icon2x=res.headers.get('X-Pass-Icon2x');const strip=res.headers.get('X-Pass-Strip');const strip2x=res.headers.get('X-Pass-Strip2x');const strip3x=res.headers.get('X-Pass-Strip3x');console.log('[PKPASS FILES USED]',{logo,logo2x,logo3x,logoSource,icon,icon2x,strip,strip2x,strip3x});}catch(_unused){}// 5) Download the pkpass\nconst blob=await res.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=\"\".concat((payload.campaignName||'pass').toString().replace(/\\s+/g,'_'),\".pkpass\");document.body.appendChild(a);a.click();a.remove();window.URL.revokeObjectURL(url);}catch(e){console.error('Generate pass failed',e);alert((e===null||e===void 0?void 0:e.message)||'Failed to generate pass');}finally{setIsGenerating(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white shadow-sm border-b border-gray-200\",children:/*#__PURE__*/_jsx(\"div\",{className:\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center h-16\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center\",children:/*#__PURE__*/_jsx(\"span\",{className:\"text-white font-bold text-sm\",children:\"\\uD83D\\uDCF1\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl font-semibold text-gray-900\",children:\"Apple Wallet Pass Designer\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500\",children:\"Create custom loyalty passes\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center space-x-1 bg-gray-100 rounded-lg p-1\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleUndo,disabled:historyIndex<=0,className:\"p-2 rounded-md hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-all\",title:\"Undo (Cmd+Z)\",children:/*#__PURE__*/_jsx(Undo2,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRedo,disabled:historyIndex>=designHistory.length-1,className:\"p-2 rounded-md hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-all\",title:\"Redo (Cmd+Shift+Z)\",children:/*#__PURE__*/_jsx(Redo2,{className:\"w-4 h-4\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"w-px h-6 bg-gray-300 mx-1\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleReset,className:\"p-2 rounded-md hover:bg-white text-red-600 hover:text-red-700 transition-all\",title:\"Reset to Default\",children:/*#__PURE__*/_jsx(RotateCcw,{className:\"w-4 h-4\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"w-px h-6 bg-gray-300\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowEditor(!showEditor),className:\"px-4 py-2 rounded-lg font-medium transition-all duration-200 \".concat(showEditor?'bg-gray-100 text-gray-700 hover:bg-gray-200':'bg-blue-600 text-white hover:bg-blue-700 shadow-sm'),children:showEditor?'Hide Editor':'Show Editor'})]})]})})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex h-[calc(100vh-64px)]\",children:[showEditor&&/*#__PURE__*/_jsx(\"div\",{className:\"w-96 bg-white border-r border-gray-200 shadow-sm\",children:/*#__PURE__*/_jsx(DesignEditor,{design:passDesign,onDesignChange:handleDesignChange})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col items-center justify-center p-8 bg-gradient-to-br from-gray-50 to-gray-100\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-8\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-2\",children:\"Live Preview\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600\",children:\"Your Apple Wallet pass updates in real-time\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-8\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"bg-white rounded-xl shadow-sm border border-gray-200 p-1\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex space-x-1\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleCardTypeChange('redemption'),className:\"flex items-center space-x-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 \".concat(passDesign.cardType==='redemption'?'bg-blue-600 text-white shadow-sm':'text-gray-600 hover:bg-gray-100 hover:text-gray-900'),children:[/*#__PURE__*/_jsx(CreditCard,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Redemption Card\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleCardTypeChange('points'),className:\"flex items-center space-x-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 \".concat(passDesign.cardType==='points'?'bg-blue-600 text-white shadow-sm':'text-gray-600 hover:bg-gray-100 hover:text-gray-900'),children:[/*#__PURE__*/_jsx(Star,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Points Card\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>handleCardTypeChange('milestone'),className:\"flex items-center space-x-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 \".concat(passDesign.cardType==='milestone'?'bg-blue-600 text-white shadow-sm':'text-gray-600 hover:bg-gray-100 hover:text-gray-900'),children:[/*#__PURE__*/_jsx(Target,{className:\"w-4 h-4\"}),/*#__PURE__*/_jsx(\"span\",{children:\"Milestone Card\"})]})]})}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-500 mt-2 text-center\",children:\"Switch between card types to access different editor controls\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"transform hover:scale-105 transition-transform duration-300\",children:/*#__PURE__*/_jsx(PassPreview,{design:passDesign})}),/*#__PURE__*/_jsx(\"div\",{className:\"mt-8 text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-center gap-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center space-x-2 px-4 py-2 bg-white rounded-lg shadow-sm border border-gray-200\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-sm text-gray-600\",children:\"Live Preview Active\"})]}),designHistory.length>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center space-x-2 px-3 py-2 bg-white rounded-lg shadow-sm border border-gray-200\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-xs text-gray-500\",children:\"History:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"text-xs font-medium text-gray-700\",children:[historyIndex+1,\" / \",designHistory.length]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:handleGeneratePass,disabled:isGenerating,className:\"px-4 py-2 rounded-lg font-medium transition-all duration-200 \".concat(isGenerating?'bg-gray-200 text-gray-500 cursor-not-allowed':'bg-blue-600 text-white hover:bg-blue-700 shadow-sm'),children:isGenerating?'Generatingâ€¦':'Generate Pass'})]})})]})]})]});}export default App;","map":{"version":3,"names":["React","useState","useCallback","PassPreview","DesignEditor","CanvasPreviewCapture","RotateCcw","Undo2","Redo2","CreditCard","Star","Target","jsx","_jsx","jsxs","_jsxs","App","defaultExp","d","Date","setFullYear","getFullYear","toISOString","slice","getDefaultDesign","cardType","arguments","length","undefined","backgroundColor","foregroundColor","labelColor","stripBackgroundColor","logoText","logoImage","logoFormat","hideLogoText","secondaryFields","label","value","auxiliaryField","stampsEarned","totalStamps","milestones","pointsBalance","pointsEarned","pointsRequired","pointsPerTransaction","nextRewardPoints","milestoneLevels","level","name","reward","currentMilestone","nextMilestonePoints","logoSize","cardWidth","cardHeight","stripHeight","headerHeight","secondaryHeight","auxiliaryHeight","barcodeHeight","qrAltText","expirationDate","hasExpiryDate","passDesign","setPassDesign","designHistory","setDesignHistory","historyIndex","setHistoryIndex","showEditor","setShowEditor","isGenerating","setIsGenerating","addToHistory","newDesign","newHistory","push","shift","handleUndo","newIndex","handleRedo","handleReset","window","confirm","defaultDesign","handleDesignChange","handleCardTypeChange","newCardType","useEffect","handleKeyDown","e","metaKey","ctrlKey","key","shiftKey","preventDefault","addEventListener","removeEventListener","handleGeneratePass","stripEl","document","querySelector","alert","capturer","stripPngDataUrl","captureStripElement","payload","campaignId","campaignName","tenantName","customerEmail","customerName","stampsRequired","colors","foreground","background","stripBackground","images","stripImage","logo","fieldConfig","fields","header","toLocaleDateString","day","month","year","replace","textAlignment","primary","auxiliary","res","fetch","method","headers","body","JSON","stringify","ok","err","json","catch","Error","message","get","logo2x","logo3x","logoSource","icon","icon2x","strip","strip2x","strip3x","console","log","_unused","blob","url","URL","createObjectURL","a","createElement","href","download","concat","toString","appendChild","click","remove","revokeObjectURL","error","className","children","onClick","disabled","title","design","onDesignChange"],"sources":["/Users/shawnlee/Documents/GitHub/passes-mktr/src/frontend/src/App.tsx"],"sourcesContent":["import React, { useState, useCallback } from 'react';\nimport PassPreview from './components/PassPreview';\nimport DesignEditor from './components/DesignEditor';\nimport { PassDesign, CardType } from './types';\nimport './App.css';\nimport { CanvasPreviewCapture } from './services/previewCapture';\nimport { RotateCcw, Undo2, Redo2, CreditCard, Star, Target } from 'lucide-react';\n\nfunction App() {\n  const defaultExp = (() => {\n    const d = new Date();\n    d.setFullYear(d.getFullYear() + 1);\n    return d.toISOString().slice(0, 10);\n  })();\n  \n  const getDefaultDesign = (cardType: CardType = 'redemption'): PassDesign => ({\n    cardType,\n    backgroundColor: '#8B4513',\n    foregroundColor: '#FFFFFF',\n    labelColor: '#FFFFFF',\n    stripBackgroundColor: '#F5F5F5',\n    logoText: 'COFFEE REWARDS',\n    logoImage: null,\n    logoFormat: 'square',\n    hideLogoText: false,\n    secondaryFields: [\n      { label: 'Card Holder', value: 'John Doe' },\n      { label: 'Redeemed', value: '4 out of 10' }\n    ],\n    auxiliaryField: {\n      label: 'Next Reward',\n      value: 'Free coffee at 10 stamps'\n    },\n    // Redemption Card Fields\n    stampsEarned: 4,\n    totalStamps: 10,\n    milestones: [5, 10],\n    // Points Card Fields\n    pointsBalance: 1250,\n    pointsEarned: 1250,\n    pointsRequired: 2000,\n    pointsPerTransaction: 50,\n    nextRewardPoints: 2000,\n    // Milestone Card Fields\n    milestoneLevels: [\n      { level: 1, name: 'Bronze', pointsRequired: 500, reward: '10% off' },\n      { level: 2, name: 'Silver', pointsRequired: 1000, reward: '15% off' },\n      { level: 3, name: 'Gold', pointsRequired: 2000, reward: '20% off' },\n      { level: 4, name: 'Platinum', pointsRequired: 5000, reward: 'Free coffee' }\n    ],\n    currentMilestone: 2,\n    nextMilestonePoints: 2000,\n    logoSize: 38,\n    cardWidth: 375,\n    cardHeight: 504,\n    stripHeight: 144,\n    headerHeight: 80,\n    secondaryHeight: 100,\n    auxiliaryHeight: 80,\n    barcodeHeight: 100,\n    qrAltText: 'Loyalty Card QR Code',\n    expirationDate: defaultExp,\n    hasExpiryDate: false\n  });\n\n  const [passDesign, setPassDesign] = useState<PassDesign>(getDefaultDesign());\n  const [designHistory, setDesignHistory] = useState<PassDesign[]>([getDefaultDesign()]);\n  const [historyIndex, setHistoryIndex] = useState(0);\n  const [showEditor, setShowEditor] = useState(true);\n  const [isGenerating, setIsGenerating] = useState(false);\n\n  // History management functions\n  const addToHistory = (newDesign: PassDesign) => {\n    // Remove any future history if we're not at the end\n    const newHistory = designHistory.slice(0, historyIndex + 1);\n    newHistory.push(newDesign);\n    \n    // Limit history to 50 items\n    if (newHistory.length > 50) {\n      newHistory.shift();\n    } else {\n      setHistoryIndex(historyIndex + 1);\n    }\n    \n    setDesignHistory(newHistory);\n    setPassDesign(newDesign);\n  };\n\n  const handleUndo = useCallback(() => {\n    if (historyIndex > 0) {\n      const newIndex = historyIndex - 1;\n      setHistoryIndex(newIndex);\n      setPassDesign(designHistory[newIndex]);\n    }\n  }, [historyIndex, designHistory]);\n\n  const handleRedo = useCallback(() => {\n    if (historyIndex < designHistory.length - 1) {\n      const newIndex = historyIndex + 1;\n      setHistoryIndex(newIndex);\n      setPassDesign(designHistory[newIndex]);\n    }\n  }, [historyIndex, designHistory]);\n\n  const handleReset = () => {\n    if (window.confirm('Are you sure you want to reset to default? This will clear all your changes and cannot be undone.')) {\n      const defaultDesign = getDefaultDesign();\n      setPassDesign(defaultDesign);\n      setDesignHistory([defaultDesign]);\n      setHistoryIndex(0);\n    }\n  };\n\n  const handleDesignChange = (newDesign: PassDesign) => {\n    addToHistory(newDesign);\n  };\n\n  const handleCardTypeChange = (newCardType: CardType) => {\n    if (newCardType === passDesign.cardType) return;\n    \n    // Create a new design with the selected card type and appropriate default fields\n    const newDesign = getDefaultDesign(newCardType);\n    \n    // Preserve some common settings\n    newDesign.backgroundColor = passDesign.backgroundColor;\n    newDesign.foregroundColor = passDesign.foregroundColor;\n    newDesign.labelColor = passDesign.labelColor;\n    newDesign.stripBackgroundColor = passDesign.stripBackgroundColor;\n    newDesign.logoText = passDesign.logoText;\n    newDesign.logoImage = passDesign.logoImage;\n    newDesign.logoFormat = passDesign.logoFormat;\n    newDesign.hideLogoText = passDesign.hideLogoText;\n    newDesign.qrAltText = passDesign.qrAltText;\n    newDesign.expirationDate = passDesign.expirationDate;\n    newDesign.hasExpiryDate = passDesign.hasExpiryDate;\n    \n    addToHistory(newDesign);\n  };\n\n  // Keyboard shortcuts\n  React.useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.metaKey || e.ctrlKey) {\n        if (e.key === 'z' && !e.shiftKey) {\n          e.preventDefault();\n          handleUndo();\n        } else if ((e.key === 'z' && e.shiftKey) || e.key === 'y') {\n          e.preventDefault();\n          handleRedo();\n        }\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [historyIndex, designHistory, handleUndo, handleRedo]);\n\n  const handleGeneratePass = async () => {\n    try {\n      setIsGenerating(true);\n      // 1) Capture strip from live preview\n      const stripEl = document.querySelector('.stamp-strip-container') as HTMLElement | null;\n      if (!stripEl) {\n        alert('Could not find the live preview strip to capture.');\n        return;\n      }\n      const capturer = new CanvasPreviewCapture();\n      const stripPngDataUrl = await capturer.captureStripElement(stripEl);\n\n      // 2) Build payload from current design\n      const payload = {\n        campaignId: '550e8400-e29b-41d4-a716-446655440001',\n        campaignName: passDesign.logoText || '',\n        tenantName: 'MKTR Platform',\n        customerEmail: 'demo@mktr.sg',\n        customerName: passDesign.secondaryFields && passDesign.secondaryFields.length > 0 ? (passDesign.secondaryFields[0].value || 'Customer Name') : 'Customer Name',\n        stampsEarned: passDesign.stampsEarned,\n        stampsRequired: passDesign.totalStamps,\n        expirationDate: passDesign.expirationDate,\n        hasExpiryDate: passDesign.hasExpiryDate,\n        colors: {\n          foreground: passDesign.foregroundColor,\n          background: passDesign.backgroundColor,\n          label: passDesign.labelColor,\n          stripBackground: passDesign.stripBackgroundColor\n        },\n        images: {\n          stripImage: stripPngDataUrl,\n          logo: passDesign.logoImage || undefined,\n          logoImage: passDesign.logoImage || undefined\n        },\n        qrAltText: passDesign.qrAltText || 'Loyalty Card QR Code',\n        fieldConfig: {\n          fields: {\n            header: [\n              passDesign.cardType === 'redemption' ? {\n                key: 'expiryDate',\n                label: 'EXPIRY',\n                value: passDesign.hasExpiryDate && passDesign.expirationDate ? (\n                  new Date(passDesign.expirationDate).toLocaleDateString('en-GB', {\n                    day: '2-digit',\n                    month: '2-digit',\n                    year: 'numeric'\n                  }).replace(/\\//g, '/')\n                ) : 'No Expiry',\n                textAlignment: 'PKTextAlignmentRight'\n              } : {\n                key: 'pointsValue',\n                label: 'POINTS',\n                value: '1836',\n                textAlignment: 'PKTextAlignmentRight'\n              }\n            ],\n            primary: [],\n            auxiliary: [\n              {\n                key: 'points',\n                label: 'POINTS',\n                value: '12,345',\n                textAlignment: 'PKTextAlignmentRight'\n              }\n            ]\n          }\n        }\n      };\n\n      // 3) Request backend to generate working pass and return .pkpass\n      const res = await fetch('/api/passes/generate-working', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      });\n\n      if (!res.ok) {\n        const err = await res.json().catch(() => ({}));\n        throw new Error(err.message || 'Failed to generate pass');\n      }\n\n      // 4) Debug: Log provenance headers for the files used\n      try {\n        const logo = res.headers.get('X-Pass-Logo');\n        const logo2x = res.headers.get('X-Pass-Logo2x');\n        const logo3x = res.headers.get('X-Pass-Logo3x');\n        const logoSource = res.headers.get('X-Pass-Logo-Source');\n        const icon = res.headers.get('X-Pass-Icon');\n        const icon2x = res.headers.get('X-Pass-Icon2x');\n        const strip = res.headers.get('X-Pass-Strip');\n        const strip2x = res.headers.get('X-Pass-Strip2x');\n        const strip3x = res.headers.get('X-Pass-Strip3x');\n        console.log('[PKPASS FILES USED]', { logo, logo2x, logo3x, logoSource, icon, icon2x, strip, strip2x, strip3x });\n      } catch {}\n\n      // 5) Download the pkpass\n      const blob = await res.blob();\n      const url = window.URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `${(payload.campaignName || 'pass').toString().replace(/\\s+/g, '_')}.pkpass`;\n      document.body.appendChild(a);\n      a.click();\n      a.remove();\n      window.URL.revokeObjectURL(url);\n    } catch (e: any) {\n      console.error('Generate pass failed', e);\n      alert(e?.message || 'Failed to generate pass');\n    } finally {\n      setIsGenerating(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Header */}\n      <div className=\"bg-white shadow-sm border-b border-gray-200\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex justify-between items-center h-16\">\n            <div className=\"flex items-center space-x-3\">\n              <div className=\"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center\">\n                <span className=\"text-white font-bold text-sm\">ðŸ“±</span>\n              </div>\n              <div>\n                <h1 className=\"text-xl font-semibold text-gray-900\">\n                  Apple Wallet Pass Designer\n                </h1>\n                <p className=\"text-sm text-gray-500\">Create custom loyalty passes</p>\n              </div>\n            </div>\n            <div className=\"flex items-center space-x-4\">\n              {/* History Controls */}\n              <div className=\"flex items-center space-x-1 bg-gray-100 rounded-lg p-1\">\n                <button\n                  onClick={handleUndo}\n                  disabled={historyIndex <= 0}\n                  className=\"p-2 rounded-md hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n                  title=\"Undo (Cmd+Z)\"\n                >\n                  <Undo2 className=\"w-4 h-4\" />\n                </button>\n                <button\n                  onClick={handleRedo}\n                  disabled={historyIndex >= designHistory.length - 1}\n                  className=\"p-2 rounded-md hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed transition-all\"\n                  title=\"Redo (Cmd+Shift+Z)\"\n                >\n                  <Redo2 className=\"w-4 h-4\" />\n                </button>\n                <div className=\"w-px h-6 bg-gray-300 mx-1\"></div>\n                <button\n                  onClick={handleReset}\n                  className=\"p-2 rounded-md hover:bg-white text-red-600 hover:text-red-700 transition-all\"\n                  title=\"Reset to Default\"\n                >\n                  <RotateCcw className=\"w-4 h-4\" />\n                </button>\n              </div>\n\n              <div className=\"w-px h-6 bg-gray-300\"></div>\n\n              <button\n                onClick={() => setShowEditor(!showEditor)}\n                className={`px-4 py-2 rounded-lg font-medium transition-all duration-200 ${\n                  showEditor \n                    ? 'bg-gray-100 text-gray-700 hover:bg-gray-200' \n                    : 'bg-blue-600 text-white hover:bg-blue-700 shadow-sm'\n                }`}\n              >\n                {showEditor ? 'Hide Editor' : 'Show Editor'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Main Content */}\n      <div className=\"flex h-[calc(100vh-64px)]\">\n        {/* Design Editor Sidebar */}\n        {showEditor && (\n          <div className=\"w-96 bg-white border-r border-gray-200 shadow-sm\">\n            <DesignEditor \n              design={passDesign} \n              onDesignChange={handleDesignChange}\n            />\n          </div>\n        )}\n\n        {/* Pass Preview */}\n        <div className=\"flex-1 flex flex-col items-center justify-center p-8 bg-gradient-to-br from-gray-50 to-gray-100\">\n          <div className=\"text-center mb-8\">\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Live Preview</h2>\n            <p className=\"text-gray-600\">Your Apple Wallet pass updates in real-time</p>\n          </div>\n          \n          {/* Card Type Selector */}\n          <div className=\"mb-8\">\n            <div className=\"bg-white rounded-xl shadow-sm border border-gray-200 p-1\">\n              <div className=\"flex space-x-1\">\n                <button\n                  onClick={() => handleCardTypeChange('redemption')}\n                  className={`flex items-center space-x-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 ${\n                    passDesign.cardType === 'redemption'\n                      ? 'bg-blue-600 text-white shadow-sm'\n                      : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900'\n                  }`}\n                >\n                  <CreditCard className=\"w-4 h-4\" />\n                  <span>Redemption Card</span>\n                </button>\n                <button\n                  onClick={() => handleCardTypeChange('points')}\n                  className={`flex items-center space-x-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 ${\n                    passDesign.cardType === 'points'\n                      ? 'bg-blue-600 text-white shadow-sm'\n                      : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900'\n                  }`}\n                >\n                  <Star className=\"w-4 h-4\" />\n                  <span>Points Card</span>\n                </button>\n                <button\n                  onClick={() => handleCardTypeChange('milestone')}\n                  className={`flex items-center space-x-2 px-4 py-3 rounded-lg font-medium transition-all duration-200 ${\n                    passDesign.cardType === 'milestone'\n                      ? 'bg-blue-600 text-white shadow-sm'\n                      : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900'\n                  }`}\n                >\n                  <Target className=\"w-4 h-4\" />\n                  <span>Milestone Card</span>\n                </button>\n              </div>\n            </div>\n            <p className=\"text-sm text-gray-500 mt-2 text-center\">\n              Switch between card types to access different editor controls\n            </p>\n          </div>\n          <div className=\"transform hover:scale-105 transition-transform duration-300\">\n            <PassPreview design={passDesign} />\n          </div>\n          <div className=\"mt-8 text-center\">\n          <div className=\"flex items-center justify-center gap-3\">\n            <div className=\"inline-flex items-center space-x-2 px-4 py-2 bg-white rounded-lg shadow-sm border border-gray-200\">\n              <div className=\"w-2 h-2 bg-green-500 rounded-full animate-pulse\"></div>\n              <span className=\"text-sm text-gray-600\">Live Preview Active</span>\n            </div>\n            {designHistory.length > 1 && (\n              <div className=\"inline-flex items-center space-x-2 px-3 py-2 bg-white rounded-lg shadow-sm border border-gray-200\">\n                <span className=\"text-xs text-gray-500\">History:</span>\n                <span className=\"text-xs font-medium text-gray-700\">\n                  {historyIndex + 1} / {designHistory.length}\n                </span>\n              </div>\n            )}\n            <button\n              onClick={handleGeneratePass}\n              disabled={isGenerating}\n              className={`px-4 py-2 rounded-lg font-medium transition-all duration-200 ${\n                isGenerating\n                  ? 'bg-gray-200 text-gray-500 cursor-not-allowed'\n                  : 'bg-blue-600 text-white hover:bg-blue-700 shadow-sm'\n              }`}\n            >\n              {isGenerating ? 'Generatingâ€¦' : 'Generate Pass'}\n            </button>\n          </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}